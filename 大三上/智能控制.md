# 1.计算机控制概述
**计算机控制技术**：把**计算机技术**与**自动化控制系统**融为一体的一门综合学问，是以**计算机**为核心部件的**过程控制系统**和**运动控制系统**。
## 1.1计算机控制系统的组成
计算机控制系统是由**常规仪表控制系统**演变而来的。常规仪表控制系统包括**闭环控制**和**开环控制：**
* **闭环控制**![](assets/智能控制.assets/Pasted%20image%2020251126230308.png)
* **开环控制**![](assets/智能控制.assets/Pasted%20image%2020251126230606.png)
计算机控制系统是用**控制计算机**代替图1-1的控制器
![](assets/智能控制.assets/Pasted%20image%2020251126230631.png)
**处理步骤：** 实时数据采集、实时数据处理、实时输出控制
**硬件组成：** 主机、常规外部设备、过程输入输出通道、操作台、通信设备
![](assets/智能控制.assets/Pasted%20image%2020251126230648.png)
![](assets/智能控制.assets/Pasted%20image%2020251126230656.png)

**软件组成**：完成各种功能的计算机程序的总和，是整个系统的神经中枢。分为**系统软件**和**应用软件**
## 1.2控制系统分类
1. **数据采集系统DAS**：所有计算机控制系统的基础![](assets/智能控制.assets/Pasted%20image%2020251126230709.png)
2. **操作指导控制系统OGC**：基于数据采集系统的一种开环结构![](assets/智能控制.assets/Pasted%20image%2020251126230715.png)
3. **直接数字控制系统DDC**：用一台计算机完成对多个被控参数的数据采集，且实时决策，并通过输出通道发出控制信号以实现对生产过程的闭环控制![](assets/智能控制.assets/Pasted%20image%2020251126230722.png)
4. **监督计算机控制系统SCC**：是**OGC系统**与**常规仪表系统**或与**DDC系统**综合而成的两级系统![](assets/智能控制.assets/Pasted%20image%2020251126230731.png)
5. **分散控制系统DCS**：以微处理器为基础，借助计算机网络对生产过程集中管理和分散控制的系统
6. **现场总线控制系统FCS**：全数字化，全分散式、可交互操作和全开放式的系统
7. **计算机集成制造系统CIMS**：将企业的各环节以及生产要素集成并统一管理。
## 1.3控制器种类
 **可编程控制器**：简称PLC，是**计算机技术**与**继电逻辑控制**概念相结合的产物，其低端为**常规继电逻辑控制**的替代装置，而高端为一种高性能的**工业控制计算机**。
 **可编程调节器**：又称单路调节器、智能调节器、数字调节器
 **总线式工控机**：基于**总线技术**和**模块化结构**的一种用于工业控制的通用计算机，一般称工业控制计算机
# 2. 模拟量输出通道
**任务**：把计算机处理后的数字量信号转换成模拟量电压或电流信号，驱动相应的执行器。
**构成**：接口电路、数/模转换器、电压/电流变换器
- **多D/A结构**：D/A内部带有数据锁存器；具有数字信号转换模拟信号、信号保持作用；结构简单，转换速度快，通道独立；但所需转换器芯片较多。![](assets/智能控制.assets/Pasted%20image%2020251127230621.png)
- **共享D/A结构**：多路共用一个转换器；每个通道配有一个采样保持放大器；D/A转换器只把数字转换成模拟信号；采样保持器实现信号保持功能；节省D/A转换器，但电路复杂，精度差，可靠低、占用主机时间。
## 2.1D/A转换器
![](assets/智能控制.assets/Pasted%20image%2020251127231005.png)
![](assets/智能控制.assets/Pasted%20image%2020251127231024.png)
![](assets/智能控制.assets/Pasted%20image%2020251127231035.png)
**性能指标**：分辨率、转换精度、偏移量误差、稳定时间
- **分辨率**：$V_{out}/(2^n-1)=V_{REF}/2^n$
- **转换精度**：实际值和理论值的接近程度
- **偏移量误差**：输入数字量时，输出模拟量对于0的偏移值
- **稳定时间**：转换速度快慢的指标，输入数字量变化到输出模拟量达到终值误差1/2LSB的时间
**8位DAC0832芯片**：
![](assets/智能控制.assets/Pasted%20image%2020251127232206.png)
**12位DAC1210芯片**
![](assets/智能控制.assets/Pasted%20image%2020251127232329.png)
## 2.2接口电路
**DAC0832接口电路**
![](assets/智能控制.assets/Pasted%20image%2020251127232437.png)
```
MOV  DX，220H     //口地址如220H送入DX    
MOV  AL，[DATA]   //被转换的数据如DATA送入累加器AL  
OUT   DX，AL      //送入D/A转换器进行转换
```
**DAC1210接口电路**
低4位输入寄存器为380H，高8位输入寄存器为381H，12位DAC寄存器为384H。
先传高八位，再传低四位
![](assets/智能控制.assets/Pasted%20image%2020251127232653.png)
```
DAC： MOV  DX，0381H 
      MOV  AL，[DATA] 
      OUT  DX，AL       ；送高8位数据
      DEC  DX
      MOV  AL，[DATA+1]
      OUT  DX，AL       ；送低4位数据
      MOV  DX，0384H
      OUT  DX，AL       ；完成12位数据转换
```
## 2.3输出方式
### 2.3.1电压输出
单极性输出：$V_{out}=-B*\frac{V_{REF}}{256}$
双极性输出：$V{out2}=V_{REF}(\frac{B}{2^{8}-1}-1)$
![](assets/智能控制.assets/Pasted%20image%2020251127233408.png)
![](assets/智能控制.assets/Pasted%20image%2020251127233421.png)
### 2.3.2电流输出方式
**普通运放V/I变换电路**：0-10；4-20
![](assets/智能控制.assets/Pasted%20image%2020251127233833.png)
![](assets/智能控制.assets/Pasted%20image%2020251127233843.png)
**集成转换器V/I变换电路**
![](assets/智能控制.assets/Pasted%20image%2020251127233909.png)
## 2.4D/A转换模板
**设计原则**：安全可靠；性价比高；通用性
**通用性**：符合总线标准、接口地址可选、输出方式可选
**设计步骤**：确定性能指标、设计电路原理图、设计和制造印制线路板、焊接和调试电路板
![](assets/智能控制.assets/Pasted%20image%2020251127234214.png)
设8路D/A转换的8个输出数据存放在内存数据段BUF0~BUF7单元中，主过程已装填DS， 8 片DAC0832的通道口地址为38H~3FH，分别存放在从CH0开始的8个连续单元中，该D/A转换模板的接口子程序：
```
DOUT PROC NEAR           ; 【子程序开始】定义名为 DOUT 的子程序，属性为 NEAR（近程）

    MOV CX, 8            ; 【设置循环次数】将计数器 CX 设为 8
                         ; 代表我们要处理 8 个 DAC 通道

    MOV BX, OFFSET BUF0  ; 【初始化数据指针】将内存变量 BUF0 的偏移地址放入 BX 寄存器
                         ; 此时 BX 指向第 1 个要转换的数据

NEXT:                    ; 【循环标号】这是循环体的起始位置

    MOV AL, [BX]         ; 【取数据】把 BX 指向的内存单元中的数据读入 AL 寄存器
                         ; 例如：第1次取 BUF0 的值，第2次取 BUF1 的值...

    OUT CH0, AL          ; 【输出数据】将 AL 中的数据输出到 CH0 变量指定的端口地址
                         ; CH0 是一个内存变量，里面存着当前的端口号（如初始为 38H）
                         ; 注意：这是教材写法，实际 CPU 执行时通常需借助 DX 寄存器

    INC CH0              ; 【修改端口地址】将变量 CH0 里的值加 1
                         ; 比如从 38H 变成 39H，目的是选中下一个 DAC0832 芯片

    INC BX               ; 【修改数据指针】将 BX 寄存器的值加 1
                         ; 让指针指向下一个内存单元（如从 BUF0 移到 BUF1）

    LOOP NEXT            ; 【循环控制】
                         ; 1. 执行 CX = CX - 1
                         ; 2. 如果 CX ≠ 0，跳转回 NEXT 处继续执行
                         ; 3. 如果 CX = 0，循环结束，向下执行

    RET                  ; 【返回】子程序执行完毕，返回主程序调用处

DOUT ENDP                ; 【子程序结束】定义结束标记
```
# 3.模拟量输入通道
![](assets/智能控制.assets/Pasted%20image%2020251129002721.png)

## 3.1 信号调理电路
电流->电压信号，电阻分压法
- 无源I/V变换：![](assets/智能控制.assets/Pasted%20image%2020251129003202.png)
- 有源I/V变换：$G=1+\frac{R_4}{R_3}$![](assets/智能控制.assets/Pasted%20image%2020251129003302.png)
## 3.2多路模拟开关
构成：电平转换、姨妈驱动、开关电路
![](assets/智能控制.assets/Pasted%20image%2020251129003352.png)
## 3.3前置放大器
![](assets/智能控制.assets/Pasted%20image%2020251129004730.png)
$G=1+R_2/R_1$    $G=-R_2/R_1$
**测量放大器**：两级相乘
![](assets/智能控制.assets/Pasted%20image%2020251129005023.png)
## 3.4采样保持器
### 3.4.1采样过程
![](assets/智能控制.assets/Pasted%20image%2020251129005638.png)
采样一般取原信号最大频率的五到十倍
### 3.4.2 零阶采样保持器
采样时充电，然后保持，但是会有损失，V的损失率为$I_D/C_H$
![](assets/智能控制.assets/Pasted%20image%2020251129010037.png)
## 3.5A/D转换器
### 3.5.1 工作原理及指标
1. 逐位逼近式A/D转换![](assets/智能控制.assets/Pasted%20image%2020251129010323.png)![](assets/智能控制.assets/Pasted%20image%2020251129010340.png)
2. 双积分式A/D转换：充电，放电并计算时间，比较器控制![](assets/智能控制.assets/Pasted%20image%2020251129010538.png)
3. 电压/频率式A/D转换：当A1为0，A2出发定时器并产生定时脉冲，开关闭合充电，直到停止，然后再正向充电C，循环。（公式见39）![](assets/智能控制.assets/Pasted%20image%2020251129010944.png)
**性能指标**：分辨率（满刻度值/2^n），转换精度（1LSB = 1／ 2n），转换时间（逐位微秒，双积分毫秒），非线性误差（1/2LSB）
### 3.5.2 ADC0809及其接口电路
8位逐位逼近式A/D转换器，模拟电压转换范围是 0 - +5 V，标准转换时间为100ms，采用28脚双立直插式封装
![](assets/智能控制.assets/Pasted%20image%2020251129011400.png)
![](assets/智能控制.assets/Pasted%20image%2020251129011405.png)
**接口电路**：查询和定时
![](assets/智能控制.assets/Pasted%20image%2020251129011440.png)
![](assets/智能控制.assets/Pasted%20image%2020251129011451.png)
**共同点**：软硬件接口简单，但转换期间独占CPU时间。双积分法采用中断法读。
## 3.6A/D转换模板
**通用性原则**：符合总线标准，接口地址可选以及输入方式可选。输入方式可选主要是指模板既可以接受单端输入信号也可以接受双端差动输入信号。
**组成**：I/O电气接口（完成电平转换、滤波、隔离等信号调理作用）；I/O功能部分（实现采样、放大、模/数转换等功能）；总线接口（完成数据缓冲、地址译码等功能）
![](assets/智能控制.assets/Pasted%20image%2020251129011923.png)
# 4.数字量输入输出通道
### 4.1 光电耦合隔离技术
电-光-电转换
![](assets/智能控制.assets/Pasted%20image%2020251129013559.png)
### 4.1.2光电耦合隔离电路
![](assets/智能控制.assets/Pasted%20image%2020251129013704.png)
## 4.2 数字量输入通道
**任务**：把生产过程中的数字信号转换成计算机易于接受的形式
**信号调理电路**：需要对各种干扰采取相应的技术措施，在外部信号与单片机之间设置输入信号调理电路
### 4.2.1开关输入电路
（1）**电平转换**：用电阻分压法把电流信号转换为电压信号。  
（2）**RC滤波**：用 RC 滤波器滤出高频干扰。  
（3）**过电压保护**：用稳压管和限流电阻作过电压保护；用稳压管或压敏电阻把瞬态尖峰电压箝位在安全电平上。  
（4）**反电压保护**：串联一个二极管防止反极性电压输入。  
（5）**光电隔离**：用光耦隔离器实现计算机与外部的完全电隔离。
开关导通，数据线为低电平0
![](assets/智能控制.assets/Pasted%20image%2020251129014459.png)
### 4.2.2 脉冲计数电路
![](assets/智能控制.assets/Pasted%20image%2020251129015003.png)
## 4.3 数字量输出通道
**任务**：把计算机输出的微弱数字信号转换成能对生产过程进行控制的数字驱动信号
**常用电路**：三极管输出驱动电路、继电器输出驱动电路、晶闸管输出驱动电路、固态继电器输出驱动电路
**选择**：根据负荷不同，如指示灯、继电器、电机等，选择不同功率的输出通道
**三极管输出驱动电路**：低压的小电流开关量，用功率三极管作为开关驱动组件，输出电流就是输入电流与三极管增益乘积（普通三极管驱动电路、达林顿驱动电路）
- **达林顿**：由多对两个三极管组成的达林顿复合管
- **特点**：高输入阻抗、高增益、输出功率大、保护措施完善，适用于计算机控制系统中的多路负荷
- **应用**：当驱动电流需要几百毫安时，如驱动中功率继电器、电磁开关等装置
**晶闸管驱动电路**：单项晶闸管、双向晶闸管（阳极A，阴极K、控制极G）
**固态继电器驱动电路**：无触点开关的电子继电器，利用电子技术实现控制回路与负载贿赂之间的电隔离和信号耦合，没有任何可动部件或触点。
- **特点**：体积小、开机速度快、无机械噪声、无抖动和回跳、寿命长
# 5.键盘及其接口技术
**键盘**：一种输入设备，是一组按键的集合
**分类**：数字键和功能键，输入数据与命令，查询和控制系统的工作状态
**键盘接口电路**：编码和非编码
1. **编码键盘**：采用硬件编码电路实现编码，每按下一个键都能产生按键代码（BCD，ASCLL）。
	- **优点**：使用方便，速度快，占用CPU时间少
	- **缺点**：对按键检测靠硬件电路，硬件电路复杂，成本高
2. **非编码键盘**：仅提供按键的通或断状态，按键代码的产生与识别由软件完成
	- **特点**：硬件电路简单，成本低，但占用CPU时间较长
## 5.1键盘输入电路
由于弹性振动，按下不能马上稳定，弹起不能完全断开，因而会出现抖动
![](assets/智能控制.assets/Pasted%20image%2020251129020854.png)
**去除抖动**：硬件方法和软件方法
- **硬件方法**：设计一个滤波延时电路或单稳态电路
- **软件方法**：编制一段时间大于100ms的延时程序
## 5.2非编码独立式键盘
### 5.2.1查询法接口电路
![](assets/智能控制.assets/Pasted%20image%2020251129021235.png)
![](assets/智能控制.assets/Pasted%20image%2020251129021330.png)
### 5.2.2中断法接口电路
查询法就是代表优先级。被动式，无键按下时不占用CPU，CPU有更多时间执行其他任务。
独立式键盘接口电路简单，软件结构简单，但每个键都需要一个I/O口线。导致连线复杂，查询按键时间长。
## 5.3非编码矩阵式键盘
**组成**：是用I/O口线组成的行、列矩阵结构，在每根行线与列线的交叉处，二线不直接相通而是通过一个按键跨接接通。
**程序设计**：在设计键盘扫描程序时，必须考虑实时性，消除抖动干扰。通用方式为编程扫描、定时扫描或中断扫描。
![](assets/智能控制.assets/Pasted%20image%2020251129022200.png)
## 5.4编码键盘
![](assets/智能控制.assets/Pasted%20image%2020251129022633.png)
# 6.显示器及其接口技术
**显示装置**：用来显示生产过程的工艺状况与运行结果
- **显示记录仪**：以模拟方式连续显示和记录过程参数的变化。价格贵
- **LED数码管**：结构简单、体积小、功耗低、配置灵活、可靠性高。被广泛采用
- **LCD**：功耗极低，袖珍仪表到便携式微型计算机
- **CRT终端**：图文并茂，可显示生产过程中各种图表（DDC、SCC、DCS）
## 6.1LED数码显示器
**工作原理**：利用PN结把电能转换成光能的固体发光器件，根据材料不同发出不同光
**结构形式**：单段圆形或方形，8段显示数字
![](assets/智能控制.assets/Pasted%20image%2020251130010159.png)
共阴极（加高电平亮）、共阳极（加低电平亮）![](assets/智能控制.assets/Pasted%20image%2020251130010248.png)
**显示方式**：把点亮LED某一段的控制称为段选，而把点亮LED某一位的控制称为位选或片选。
**静态显示方式**：4个COM端连接在一起并接有效电平——无位选；每个LED的段选各自与一个8位并行I/O口相连——段选独立。
缺点是电路中占用I/O口资源多；优点是占用CPU机时少，显示稳定可靠。适用：规模较大的实时控制系统。
![](assets/智能控制.assets/Pasted%20image%2020251130010702.png)
**动态显示方式**：4个LED显示器各自的段选线连在一起，与一个8位的I/O口相连；各自的COM端则由另一个I/O口进行位选。
优点是占用I/O资源少；缺点是需用软件程序不断地循环扫描定时刷新，因而占用了CPU的大多数机时。适用：小型测控系统
![](assets/智能控制.assets/Pasted%20image%2020251130010733.png)
**接口电路**：显示部分、锁存器、译码、驱动电路
**静态显示接口电路**：锁存、译码、驱动均由硬件实现——CD4511B。
实现过程－－74LS138输出作为LED片选，每两个共用一个片选；每两个段选码共用一个字节；
```
MOV     BX，OFFSET  DATA1
MOV     AL，[BX]
OUT      PORT0，AL    ；显示左2位
INC       BX
MOV     AL，[BX]
OUT      PORT1，AL    ；显示右2位
```
**动态显示接口电路**：锁存、驱动由硬件电路实现；段选码的译码由软件实现。
![](assets/智能控制.assets/Pasted%20image%2020251130011134.png)
## 6.2LCD液晶显示器
利用液晶的扭曲/向列效应制成的新型显示器。分为段位式、字符式、点阵式。
**驱动方式**：直接驱动（1个背极，每个字符有独立引脚）、多级驱动（多个背极。各字符段按点阵结构排列）
## 6.3图形显示器
1. **CRT显示器**：由一个图形监示器和相应的  控制电路组成。（丰富的画面指令和窗口功能；体积与功耗大，易受震动和冲击）
2. **TFT显示器**：体积小，耗电少、可靠性高、寿命长、不易受到冲击、可扩展性高
**作用**：直观形象监视和操作工业生产过程。便于单元操作控制；要有实时动态数据，又要有历史记忆功能。
**内容**：调节器、指示仪、记录仪、报警仪、模拟屏、开关按钮、指示灯
**显示画面**：总貌画面、分组画面、点画面、流程图画面、趋势曲线画面、报警显示画面、操作指导画面
# 7.数据处理技术
**数据采集**：通过传感器、变送器把生产过程的各种物理参数转换成电信号，然后经A/D或DI通道送入计算机中
**数据处理**：根据需要进行相应的数据处理（预处理、数字滤波、标度变换、查表、越限报警）
## 7.1 测量数据预处理技术
### 7.1.1 系统误差的自动校准
**系统误差**：一般存在于放大器等器件的零点偏移和漂移，造成放大电路的增益误差和器件参数的不稳定等现象
**特点**：在一定测量条件下，变化规律可以掌握，原因一般也可以知道
**处理方法**：数字调零、系统校准，一般采用软件程序进行处理
![](assets/智能控制.assets/Pasted%20image%2020251130221533.png)
1. **数字调零**：通过软件处理由零点偏移造成的误差
	1. **优点**：可去掉放大电路，A/D转换电路本身的偏移及随时间于与温度发生的各种偏移影响，降低这些器件对偏移值的要求，降低硬件成本
	2. **缺点**：不能校正由传感器本身引入的误差
2. **系统校准**：克服由传感器本身引入的误差，$V=V_R/N_RN$。适用于传感器特性随时间变化的场合
### 7.1.2数据字长预处理
1. **输入位数大于输出位数**：忽略高位数的最低几位
2. **输入位数小于输出位数**：左移并用0填充
## 7.2 数字滤波方法
### 7.2.1 平均值滤波
**种类**：算术平均、去极值平均、加权平均、滑动平均
- 1和2都是采样m次计算。
- 去极值适用于经常遇到尖脉冲干扰的信号滤波的工业场合，但灵敏度和平滑度较差
- 加权的权重符合sigmoid
- 上述三种当系统采样速度慢或采样信号变化快，系统的实时性无法保证
- 滑动平均在每个采样周期只采样一次，将该值和过去的采样值一起求平均；实时性好，提高响应速度
### 7.2.2 中值滤波
把m次采样值按大小排序，取其中间值作为有效采样值，一般3~5次即可
**适用场合**：对缓变过程中偶然因素引起的波动或采样器不稳定造成的误差所引起的脉动干扰比较有效，对快速变化过程的信号采样不适用
### 7.2.3 限幅滤波
![](assets/智能控制.assets/Pasted%20image%2020251130223116.png)
**适用场合**：对随机干扰或采样器不稳定所引起的失真有良好滤波效果
### 7.2.4 惯性滤波

**实现方法**：高精度的RC电路不易制作，所以硬件RC滤波器不能对极低频率的信号滤波。所以用软件做成低通数字滤波器，实现一阶惯性数字滤波








